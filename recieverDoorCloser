
#include <Servo.h>


#include <RH_ASK.h>
#include <SPI.h> // Not actually used but needed to compile

int button=0;

Servo myservo;
int pos=0;
boolean dooropen= false;
int motor=A3;
RH_ASK driver(2000, 3, 4, 5); 
int buttonPin=6;

void setup()
{
    Serial.begin(115200);	  // Debugging only
    Serial.println("working");
    if (!driver.init())
         Serial.println("init failed");
    myservo.attach(8);
    pinMode(motor,OUTPUT);
    pinMode(buttonPin,INPUT);

}

void loop()
{

    
    uint8_t buf[RH_ASK_MAX_MESSAGE_LEN];
    uint8_t buflen = sizeof(buf);
 
    if(driver.recv(buf, &buflen)) {
	 int i;
	    driver.printBuffer("Got:", buf, buflen);

      String rcv;
      for(int i =0; i<buflen; i++) {
        rcv += (char)buf[i];
      Serial.println(rcv);  
      }
      
      if(rcv=="run"){
        Serial.println("Should be running");
        myservo.write(120);
        analogWrite(motor,255);
        dooropen=true;
       
       }else{
        ;
       }
        
     }
     while(dooropen){
        
        button=digitalRead(buttonPin);
        // if switch is pressed stop motor and lift servo
        if(button==HIGH){
          Serial.print("button is high");
          myservo.write(0);
          analogWrite(motor,0);
          dooropen=false;
        }
     }
    
}
